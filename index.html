<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>AI游戏推荐 · v7 HTML 直出版</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* 细节优化 */
    .no-scrollbar::-webkit-scrollbar{display:none}
    .no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}
    html,body{background:#0B0D13}
  </style>
  <!-- React 18 + ReactDOM UMD -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <!-- Framer Motion UMD (提供全局 window.framerMotion) -->
  <script src="https://unpkg.com/framer-motion/dist/framer-motion.umd.js"></script>
  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    /*********************************
     *  Runtime 安全导入 & Fallback（修复：Element type is invalid）
     *  - 某些环境中 window.framerMotion 可能不存在，或其成员未就绪
     *  - 这里提供安全降级：
     *      motion.xxx => 返回普通的 <xxx> 元素（保留布局，不报错）
     *      AnimatePresence => 直接渲染 children
     *********************************/
    const FM = (window.framerMotion || window["framer-motion"] || {});
    const makeStub = (Tag) => (props) => React.createElement(Tag, props, props?.children);
    const MotionStub = new Proxy({}, { get: (_, tag) => makeStub(tag) });
    const motion = FM.motion || MotionStub;
    const AnimatePresence = FM.AnimatePresence || (({ children }) => <>{children}</>);

    // 基础 React Hooks
    const { useMemo, useState } = React;

    /*********************************
     *  轻量自检用例（可展开查看）
     *********************************/
    function runSelfTests(){
      const cases = [
        { name: 'React 存在', fn: () => !!React && !!ReactDOM },
        { name: 'framer-motion 全局可见', fn: () => !!window.framerMotion },
        { name: 'motion 可用（函数或 Proxy）', fn: () => typeof motion === 'object' && typeof motion.div === 'function' },
        { name: 'AnimatePresence 可用', fn: () => typeof AnimatePresence === 'function' },
      ];
      return cases.map(c => ({ name: c.name, pass: !!(c.fn()) }));
    }

    /*********************************
     *  数据与常量（与 v4 对齐并补充）
     *********************************/
    const GAME = {
      name: "Identity V · 第五人格",
      subtitle: "1v4 非对称对抗 · 哥特悬疑",
      tags: ["非对称对抗", "哥特悬疑", "多人竞技", "剧情沉浸"],
      moods: ["紧张感", "推理欲", "共斗", "反转剧情"],
      heroLines: [
        "你曾多次停留在 1v4 策略与悬疑题材上，这款游戏与你的游玩偏好高度重合。",
      ],
      highlights: [
        { title: "非对称竞技巅峰", desc: "1v4 脑力博弈，猎人与求生者策略拉满" },
        { title: "悬疑剧情氛围", desc: "哥特视觉 + 庄园真相，沉浸感极强" },
        { title: "角色羁绊成长", desc: "每位监管者/求生者皆有独立命运线" },
      ],
    };

    const VISUAL_SETS = {
      玩法: [
        { t: "核心机制", s: "追击、救援、破译、电机协作" },
        { t: "上手技巧", s: "熟悉地形 + 合理转点 + 团队语音协作" },
        { t: "节奏预估", s: "单局 10–15min · 排位上分建议四排" },
      ],
      视觉: [
        { t: "核心风格", s: "哥特 + 维多利亚式建筑风格" },
        { t: "特效演出", s: "雾气、火光、追逐视角沉浸渲染" },
      ],
      剧情: [
        { t: "主线剧情", s: "庄园秘密与人格实验" },
        { t: "角色关系", s: "监管者与求生者的宿命纠缠" },
      ],
      口碑: [
        { t: "社区热词", s: "#排位惊魂 #演绎之星 #深渊盛典" },
        { t: "玩家评价", s: "非对称设计天花板 · 氛围与剧情并存" },
      ],
    };

    const SIMS = {
      newbie: [
        { title: "赤潮：零域", why: "处决手感与节奏相近，10 分钟一局" },
        { title: "铁城残响", why: "悬疑反转 + 都市废土氛围" },
        { title: "弈仙牌", why: "快节奏对抗，策略反馈强" },
        { title: "霓虹协奏", why: "双人协同，音律打击感" },
      ],
      veteran: [
        { title: "黎明追猎", why: "你常用监管者路径相近：控制 → 压电机 → 收割" },
        { title: "影城迷踪", why: "你偏好解密+转点，本作地形利用更强" },
        { title: "暗潮车站", why: "你在 10–15min 局留存高，节奏契合" },
        { title: "旧都绮梦", why: "剧情反转密度高，适合你的剧情偏好" },
      ],
    };

    /*********************************
     *  基础视觉组件
     *********************************/
    function GlassCard({ children, className = "" }) {
      return (
        <div className={"rounded-3xl border border-white/10 bg-white/5 backdrop-blur-xl shadow-[0_8px_40px_rgba(0,0,0,0.35)] " + className}>{children}</div>
      );
    }
    function Badge({ children }) {
      return (
        <span className="inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-[11px] bg-white/10 border border-white/10 text-white/90">{children}</span>
      );
    }
    function PrimaryButton({ children, onClick, className = "" }) {
      return (
        <button onClick={onClick} className={"px-4 py-2 rounded-2xl text-sm font-medium text-white bg-gradient-to-r from-[#2CD9FF] via-[#6C6CFF] to-[#A445FF] shadow-[0_6px_20px_rgba(82,122,255,0.45)] hover:shadow-[0_10px_28px_rgba(82,122,255,0.65)] active:translate-y-[1px] " + className}>{children}</button>
      );
    }
    function GhostButton({ children, onClick, className = "" }) {
      return (
        <button onClick={onClick} className={"px-4 py-2 rounded-2xl text-sm font-medium text-white/90 border border-white/15 bg-white/5 hover:bg-white/10 active:translate-y-[1px] " + className}>{children}</button>
      );
    }

    /*********************************
     *  v4 原子组件（完整保留）
     *********************************/
    function TrustBar({ line, value = 95 }) {
      return (
        <GlassCard className="p-4 md:p-5 mt-4">
          <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
            <div className="text-sm md:text-base text-white/90">{line}</div>
            <div className="flex items-center gap-4 w-full md:w-auto">
              <div className="w-full md:w-64">
                <div className="flex justify-between text-[11px] text-white/60 mb-1"><span>匹配度</span><span>{value}%</span></div>
                <div className="h-2 rounded-full bg-white/10 overflow-hidden">
                  {motion ? (
                    <motion.div initial={{ width: 0 }} animate={{ width: `${value}%` }} transition={{ duration: 1.2 }} className="h-full bg-gradient-to-r from-emerald-400 to-cyan-400" />
                  ) : (
                    <div className="h-full bg-gradient-to-r from-emerald-400 to-cyan-400" style={{ width: `${value}%`, transition: 'width 1.2s ease' }} />
                  )}
                </div>
                <div className="text-[11px] mt-1 text-emerald-300/90">现在下载，赠送你的专属皮肤</div>
              </div>
              <div className="relative">
                <svg viewBox="0 0 36 36" className="w-10 h-10 -rotate-90">
                  <path d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32" fill="none" stroke="rgba(255,255,255,.15)" strokeWidth="4" />
                  {motion ? (
                    <motion.path d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32" fill="none" stroke="url(#grad)" strokeWidth="4" strokeLinecap="round" strokeDasharray="100 100" initial={{ strokeDashoffset: 100 }} animate={{ strokeDashoffset: 5 }} transition={{ duration: 1.2 }} />
                  ) : (
                    <path d="M18 2 a 16 16 0 1 1 0 32 a 16 16 0 1 1 0 -32" fill="none" stroke="url(#grad)" strokeWidth="4" strokeLinecap="round" strokeDasharray="100 100" />
                  )}
                  <defs>
                    <linearGradient id="grad" x1="0" x2="1"><stop offset="0%" stopColor="#2CD9FF" /><stop offset="100%" stopColor="#A445FF" /></linearGradient>
                  </defs>
                </svg>
              </div>
            </div>
          </div>
        </GlassCard>
      );
    }

    function MultiView({ dataset }) {
      const keys = Object.keys(dataset);
      const defaultKey = keys.includes("玩法") ? "玩法" : keys[0];
      const [tab, setTab] = useState(defaultKey);
      const list = dataset[tab];
      return (
        <div className="mt-6">
          <div className="flex gap-2 flex-wrap">
            {keys.map((k) => (
              <button key={k} onClick={() => setTab(k)} className={`px-3 py-1 rounded-full text-sm border ${k === tab ? "bg-gradient-to-r from-[#2CD9FF] to-[#A445FF] text-white border-transparent" : "bg-white/5 text-white/80 border-white/10 hover:bg-white/10"}`}>{k}</button>
            ))}
          </div>
          {motion ? (
            <motion.div key={tab} initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.25 }} className="mt-3 grid md:grid-cols-3 gap-3">
              {list.map((item, i) => (
                <GlassCard key={i} className="p-4 group">
                  <div className="text-sm font-semibold text-white/90">{item.t}</div>
                  <div className="text-sm text-white/70 mt-1">{item.s}</div>
                  <div className="mt-3 h-24 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-xs text-white/40 group-hover:text-white/70 transition">预览占位（AI 自动拼接片段）</div>
                </GlassCard>
              ))}
            </motion.div>
          ) : (
            <div className="mt-3 grid md:grid-cols-3 gap-3">
              {list.map((item, i) => (
                <GlassCard key={i} className="p-4 group">
                  <div className="text-sm font-semibold text-white/90">{item.t}</div>
                  <div className="text-sm text-white/70 mt-1">{item.s}</div>
                  <div className="mt-3 h-24 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-xs text-white/40 group-hover:text-white/70 transition">预览占位（AI 自动拼接片段）</div>
                </GlassCard>
              ))}
            </div>
          )}
        </div>
      );
    }

    function SocialRadar() {
      const [open, setOpen] = useState(false);
      return (
        <GlassCard className="p-4 mt-4">
          <div className="flex items-center justify-between">
            <div className="text-sm font-semibold text-white/90">实时社交热度雷达</div>
            <button className="text-xs underline text-white/70" onClick={() => setOpen(!open)}>{open ? "收起" : "展开"}</button>
          </div>
          <div className="text-xs text-white/60 mt-1">在线：18.2 万 · 好友：小明(监管者大师段位) · 直播：鬼哭狼嚎(12 万观看)</div>
          <AnimatePresence>
            {open && (
              <motion.div initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: "auto" }} exit={{ opacity: 0, height: 0 }} className="mt-3 grid md:grid-cols-3 gap-3">
                {[{ t: "好友在线", s: "小明 · 连胜 3 场 · 正在匹配" },{ t: "高能直播", s: "鬼哭狼嚎：监管者教学 · 12 万围观" },{ t: "话题热度", s: "#电机拉扯 #监管者压制 #四排上分" }].map((x) => (
                  <GlassCard key={x.t} className="p-3"><div className="text-xs font-semibold text-white/90">{x.t}</div><div className="text-xs text-white/70 mt-1">{x.s}</div></GlassCard>
                ))}
              </motion.div>
            )}
          </AnimatePresence>
          <div className="mt-2 flex gap-2"><PrimaryButton>观战</PrimaryButton><GhostButton>组队匹配</GhostButton></div>
        </GlassCard>
      );
    }

    function SimilarRow({ variant = "newbie" }) {
      const sims = SIMS[variant] || SIMS.newbie;
      return (
        <div className="mt-6">
          <div className="text-sm font-semibold mb-2 text-white/90">你可能也会喜欢（相似气质）</div>
          <div className="flex gap-3 overflow-x-auto no-scrollbar pr-2">
            {sims.map((s) => (
              <GlassCard key={s.title} className="min-w-[220px] p-3 hover:-translate-y-0.5 transition">
                <div className="h-28 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-xs text-white/40">封面占位</div>
                <div className="mt-2 text-sm font-medium text-white/90">{s.title}</div>
                <div className="text-xs text-white/60">{s.why}</div>
                <div className="mt-2 flex gap-2"><PrimaryButton className="px-3 py-1">试玩</PrimaryButton><GhostButton className="px-3 py-1">对比</GhostButton></div>
              </GlassCard>
            ))}
          </div>
        </div>
      );
    }

    /*********************************
     *  头部封面与模式切换
     *********************************/
    function BasicInfoCard() {
      return (
        <div className="absolute left-5 bottom-5 text-white drop-shadow-xl">
          <div className="text-2xl md:text-3xl font-bold tracking-tight">{GAME.name}</div>
          <div className="text-xs opacity-90 mt-1">{GAME.subtitle}</div>
          <div className="mt-2 flex flex-wrap gap-2">{GAME.tags.map((t) => (<Badge key={t}>{t}</Badge>))}</div>
        </div>
      );
    }
    function PersonaIntro() {
      return (
        <GlassCard className="absolute right-5 bottom-5 max-w-[320px] p-4 hidden md:block">
          <div className="text-sm font-medium text-white/90">👻 幽灵管家：欢迎来到欧利蒂丝庄园！</div>
          <div className="text-xs mt-1 leading-relaxed text-white/70">我扫描了你的游玩记录：<br />• 偏好悬疑与 1v4 → 匹配度 95%🔥<br />• 平均时长 15 分钟 → 适配碎片娱乐<br />• 最近观影《死侍》《惊声尖叫》 → 推荐人格“收藏家”</div>
          <div className="mt-2 flex gap-2 flex-wrap">{["我当猎人", "我逃生", "随机体验"].map((opt) => (<GhostButton key={opt} className="px-3 py-1 text-xs">{opt}</GhostButton>))}</div>
        </GlassCard>
      );
    }
    function ModeSwitchBar({ mode, switchTo }) {
      return (
        <div className="absolute top-4 right-4">
          <div className="bg-white/10 backdrop-blur-lg rounded-full border border-white/15 text-xs p-1 flex gap-1">
            <button onClick={() => switchTo("newbie")} className={`px-3 py-1 rounded-full ${mode === "newbie" ? "bg-gradient-to-r from-[#2CD9FF] to-[#A445FF] text-white" : "text-white/80 hover:bg-white/10"}`}>未玩</button>
            <button onClick={() => switchTo("veteran")} className={`px-3 py-1 rounded-full ${mode === "veteran" ? "bg-gradient-to-r from-[#2CD9FF] to-[#A445FF] text-white" : "text-white/80 hover:bg-white/10"}`}>已玩</button>
          </div>
        </div>
      );
    }

    /*********************************
     *  已玩用户增益层
     *********************************/
    function WelcomeBackBar() {
      return (
        <GlassCard className="p-4 mt-4"><div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3"><div className="text-sm text-white/80">欢迎回来！上次游玩：昨晚 22:17 · 本周在线 4 次</div><div className="flex gap-2 flex-wrap">{[{ t: "继续游戏" }, { t: "自定义房间" }, { t: "观战好友" }, { t: "每日任务" }].map((b) => (<GhostButton key={b.t} className="px-3 py-1 text-xs">{b.t}</GhostButton>))}</div></div></GlassCard>
      );
    }
    function MyProgressCard() {
      return (
        <div className="mt-4 grid md:grid-cols-2 gap-3">
          <GlassCard className="p-4"><div className="text-sm font-semibold text-white/90">我的进度</div><div className="mt-2 grid grid-cols-2 gap-2 text-xs text-white/75"><div>段位：五阶 · ⭐⭐⭐</div><div>近 20 局胜率：58%</div><div>常用阵营：监管者 62%</div><div>角色熟练度：雕刻家 S / 守夜人 A</div><div>赛季任务：完成度 72%</div><div>登录连击：7 天</div></div></GlassCard>
          <GlassCard className="p-4"><div className="text-sm font-semibold text-white/90">AI 复盘建议 · Top 3</div><ol className="list-decimal ml-4 mt-2 text-xs text-white/85 space-y-1"><li>监管者普攻命中率偏低（46%）→ 练习“转点预判 + 夹角逼仄”。</li><li>前期压电机节奏慢 → 前 90 秒优先巡逻三角区，减少盲追。</li><li>被救后常被二次击倒 → 建议练习“楼层换位 + 拉视野”。</li></ol><PrimaryButton className="mt-3 px-3 py-1">一键生成 60s 复盘短片</PrimaryButton></GlassCard>
        </div>
      );
    }
    function FriendsGuildActivity() {
      return (
        <GlassCard className="p-4 mt-4"><div className="text-sm font-semibold text-white/90">好友与公会动态</div><div className="mt-2 grid md:grid-cols-3 gap-3 text-xs text-white/85"><GlassCard className="p-3">小明：监管者连胜 3 场 · 邀你加入</GlassCard><GlassCard className="p-3">公会今晚 21:00 训练赛（四排）</GlassCard><GlassCard className="p-3">周排名：你当前第 12 名（↑2）</GlassCard></div><div className="mt-2 flex gap-2"><PrimaryButton className="px-3 py-1 text-xs">加入</PrimaryButton><GhostButton className="px-3 py-1 text-xs">观战</GhostButton></div></GlassCard>
      );
    }
    function PatchNews() {
      return (
        <GlassCard className="p-4 mt-4"><div className="text-sm font-semibold text-white/90">版本与活动情报</div><ul className="mt-2 text-xs text-white/85 list-disc ml-4 space-y-1"><li>本周末排位积分加成 +50%</li><li>新皮肤“夜行者”限时返场（监管者）</li><li>赛事：深渊盛典预选赛 · 直播入口已开启</li><li>平衡调整：守夜人能量回复 -5%</li></ul></GlassCard>
      );
    }
    function PersonalizedShop() {
      return (
        <GlassCard className="p-4 mt-4"><div className="text-sm font-semibold text-white/90">个性化商店（与你相关）</div><div className="mt-2 grid md:grid-cols-3 gap-3 text-xs">{[{ t: "收藏家：血色刻印（你未拥有）", a: "试衣间" },{ t: "雕刻家：古堡礼赞（本周折扣）", a: "加入愿望单" },{ t: "守夜人：极夜之途（联动皮肤）", a: "AR 试穿" }].map((x) => (<GlassCard key={x.t} className="p-3"><div className="text-white/85">{x.t}</div><GhostButton className="mt-2 px-3 py-1 text-xs">{x.a}</GhostButton></GlassCard>))}</div></GlassCard>
      );
    }

    /*********************************
     *  新增模块
     *********************************/
    function SectionTitle({ title, subtitle }) {
      return (
        <div className="mb-3"><h3 className="text-lg font-semibold text-white/90">{title}</h3>{subtitle && <p className="text-xs text-white/60">{subtitle}</p>}</div>
      );
    }
    function AIExplainerBlock() {
      return (
        <GlassCard className="mt-6">
          <SectionTitle title="🎙 AI讲解 & 为什么推荐给我" subtitle="AI 主播演讲效果图 + 个性化理由" />
          <div className="grid md:grid-cols-2 gap-4 items-center">
            <div className="h-52 rounded-2xl relative overflow-hidden bg-[url('/ai-host-demo.png')] bg-cover bg-center">
              <div className="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent" />
              <div className="absolute bottom-2 left-2 text-xs text-white/90 bg-black/40 px-2 py-1 rounded-md">AI 主播演讲中…</div>
            </div>
            <div className="text-sm text-white/80 leading-relaxed">
              <p>🧠 根据你的偏好画像：悬疑题材 + 1v4 对抗 → 匹配度 95%。</p>
              <ul className="list-disc ml-4 mt-2 space-y-1">
                <li>你喜好快节奏 10–15 分钟一局，推荐新手教学局。</li>
                <li>你在非对称类目停留时长更高，策略博弈契合度强。</li>
                <li>近期观看内容与哥特氛围相近，剧情沉浸加分。</li>
              </ul>
              <div className="mt-3 flex gap-2"><PrimaryButton className="px-3 py-1 text-xs">▶ 听AI讲解</PrimaryButton><GhostButton className="px-3 py-1 text-xs">查看完整推荐依据</GhostButton></div>
            </div>
          </div>
        </GlassCard>
      );
    }
    function PersonalizedBenefitsCenter() {
      return (
        <GlassCard className="mt-6">
          <SectionTitle title="🎁 我的个性化礼券与福利" subtitle="每日签到 · 成就奖励 · 限时礼包" />
          <div className="grid md:grid-cols-3 gap-3 text-sm text-white/85">
            {[{t:'今日签到礼',desc:'庄园银币 x200 · 线索碎片 x3'},{t:'成就勋章',desc:'完成“连胜三场”解锁狩猎徽章'},{t:'限时福利包',desc:'稀有时装券 + 钻石加赠'}].map((x)=>(
              <GlassCard key={x.t} className="bg-gradient-to-br from-[#2CD9FF]/10 to-[#A445FF]/10 p-4"><div className="font-semibold mb-1">{x.t}</div><p>{x.desc}</p><PrimaryButton className="mt-3 px-3 py-1 text-xs">立即领取</PrimaryButton></GlassCard>
            ))}
          </div>
        </GlassCard>
      );
    }
    function GameHighlights() {
      return (
        <GlassCard className="mt-6">
          <SectionTitle title="🔥 游戏核心亮点" subtitle="让你 10 秒读懂这款游戏的独特性" />
          <div className="grid md:grid-cols-3 gap-4">{GAME.highlights.map((h) => (<div key={h.title} className="rounded-xl p-4 bg-white/5 border border-white/10 hover:bg-white/10 transition"><div className="text-sm font-semibold text-white/90 mb-1">{h.title}</div><p className="text-xs text-white/70">{h.desc}</p></div>))}</div>
        </GlassCard>
      );
    }
    function AIAgentEntry({ floating = false }) {
      const content = (
        <GlassCard className="p-4 md:p-6 flex flex-col md:flex-row items-center justify-between gap-3">
          <div>
            <h3 className="text-lg font-semibold text-white/90 mb-1">🤖 游戏 AI Agent 助手</h3>
            <p className="text-sm text-white/70 max-w-[420px]">想找更多类似游戏？或关于《第五人格》的任何问题？立即咨询 AI 助手，获得实时推荐与玩法指导。</p>
          </div>
          <PrimaryButton className="mt-2 md:mt-0">立即与 AI 对话 ➜</PrimaryButton>
        </GlassCard>
      );
      if (!floating) return <div className="mt-6">{content}</div>;
      return (
        <div className="fixed right-5 top-[88px] z-40 hidden lg:block opacity-95 hover:opacity-100 transition">{content}</div>
      );
    }

    /*********************************
     *  主组件
     *********************************/
    function DevSelfTestPanel(){
      const [open,setOpen] = useState(false);
      const results = runSelfTests();
      return (
        <div className="mt-8">
          <button onClick={()=>setOpen(!open)} className="text-xs text-white/70 underline">{open? '收起调试自检' : '展开调试自检（排查 framer-motion 加载问题）'}</button>
          {open && (
            <GlassCard className="p-4 mt-2">
              <div className="text-sm font-semibold text-white/90">自检结果</div>
              <ul className="mt-2 text-xs text-white/80 space-y-1">
                {results.map((r,i)=> (
                  <li key={i} className={r.pass? 'text-emerald-300' : 'text-rose-300'}>
                    {r.pass ? '✔ ' : '✖ '}{r.name}
                  </li>
                ))}
              </ul>
              <div className="text-[11px] text-white/60 mt-2">若 “framer-motion 全局可见” 失败，确认网络能访问 unpkg，并保持本 HTML 中的 framer-motion 脚本标签顺序在 React 之后、Babel 之前。</div>
            </GlassCard>
          )}
        </div>
      );
    }

    function App(){
      const [toast, setToast] = useState(null);
      const [showGift, setShowGift] = useState(false);
      const [tabData] = useState(VISUAL_SETS);
      const [mode, setMode] = useState("newbie"); // newbie | veteran
      const oneLine = useMemo(() => GAME.heroLines[0], []);

      const onTryNow = () => {
        setToast(mode === "newbie" ? "已为你开启‘15 分钟新手体验局’：低配对手 + 教学提示" : "继续游戏匹配中：沿用你上次监管者配置");
        setTimeout(() => setToast(null), 2000);
        if (mode === "newbie") setTimeout(() => setShowGift(true), 2200);
      };
      const switchTo = (m) => setMode(m);

      return (
        <div className="min-h-screen bg-[#0B0D13] text-white">
          {/* 背景装饰 */}
          <div className="pointer-events-none fixed inset-0 bg-[radial-gradient(circle_at_20%_10%,rgba(108,108,255,.18),transparent_40%),radial-gradient(circle_at_80%_30%,rgba(44,217,255,.16),transparent_45%),radial-gradient(circle_at_50%_80%,rgba(164,69,255,.14),transparent_40%)]" />

          {/* 顶部浮动 AI Agent 快捷入口 */}
          <AIAgentEntry floating />

          <div className="relative max-w-6xl mx-auto px-4 py-6 md:py-10">
            {/* 顶部沉浸封面 */}
            <div className="relative w-full overflow-hidden rounded-3xl shadow-2xl">
              <div className="relative h-64 md:h-80 bg-[#0E1016]">
                <div className="absolute inset-0 bg-[radial-gradient(60%_60%_at_30%_30%,rgba(44,217,255,.25),transparent_60%)]" />
                <div className="absolute inset-0 bg-gradient-to-t from-[#0E1016] via-transparent to-[#0E1016]/40" />
                <BasicInfoCard />
                {mode === "newbie" ? <PersonaIntro /> : null}
                <ModeSwitchBar mode={mode} switchTo={switchTo} />
              </div>
            </div>

            {/* 核心信息：未玩 / 已玩 */}
            {mode === "newbie" ? (
              <>
                <TrustBar line={oneLine} value={95} />
                <div className="mt-4 flex flex-wrap gap-3">
                  <PrimaryButton onClick={onTryNow}>🎮 一键试玩</PrimaryButton>
                  <GhostButton>🎙 AI 讲解：快速上手</GhostButton>
                  <GhostButton>🧠 为什么推荐给我</GhostButton>
                </div>
                {/* 新增：核心亮点 + AI讲解区块 */}
                <GameHighlights />
                <AIExplainerBlock />
              </>
            ) : (
              <>
                <WelcomeBackBar />
                <MyProgressCard />
              </>
            )}

            {/* 社交验证层 */}
            <SocialRadar />

            {/* 深度内容 */}
            <MultiView dataset={tabData} />

            {/* 相似游戏推荐 */}
            <SimilarRow variant={mode === "veteran" ? "veteran" : "newbie"} />

            {/* 已玩专属 */}
            {mode === "veteran" && (<><FriendsGuildActivity /><PatchNews /><PersonalizedShop /></>)}

            {/* 个性化礼券福利中心 */}
            <PersonalizedBenefitsCenter />

            {/* 非悬浮版 Agent 入口 */}
            <AIAgentEntry />

            {/* 场景标签 */}
            <div className="mt-6">
              <div className="text-sm font-semibold mb-2 text-white/90">当下场景</div>
              <div className="flex flex-wrap gap-2">
                {["下班 10 分钟爽一把", "和搭子联机", "剧情沉浸夜", "摸鱼午休局"].map((s) => (
                  <button key={s} onClick={() => onTryNow()} className="px-3 py-1 rounded-full text-xs bg-white/10 text-white/85 border border-white/10 hover:bg-white/15">{s}</button>
                ))}
              </div>
            </div>

            {/* 调试自检面板 */}
            <DevSelfTestPanel />

            {/* 礼包浮层（未玩触发） */}
            <AnimatePresence>{showGift && mode === "newbie" && (
              <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 10 }} className="fixed bottom-6 right-6 z-50">
                <GlassCard className="p-4">
                  <div className="text-sm font-semibold text-white/90">🎁 小V专属礼包</div>
                  <ul className="text-xs mt-2 text-white/80 list-disc ml-4">
                    <li>收藏家专属涂鸦（你的 ID 刻印）</li>
                    <li>7 天 VIP · 活跃时段定制</li>
                    <li>好友邀请双倍钻石</li>
                  </ul>
                  <PrimaryButton className="mt-3 px-3 py-1">扫码领取</PrimaryButton>
                </GlassCard>
              </motion.div>
            )}</AnimatePresence>

            {/* Toast 提示 */}
            <AnimatePresence>{toast && (
              <motion.div initial={{ opacity: 0, y: 8 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: 8 }} className="fixed bottom-6 left-1/2 -translate-x-1/2 bg-black/80 text-white text-sm px-4 py-2 rounded-full border border-white/10 shadow-xl">{toast}</motion.div>
            )}</AnimatePresence>

            {/* 页脚 */}
            <div className="mt-10 text-center text-xs text-white/50">v7 · 在 v4 的完整功能上融合新增模块 · 顶部浮动 Agent 入口 + 心流优化</div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
